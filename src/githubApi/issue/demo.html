

<div class="markdown prose w-full break-words dark:prose-invert dark"><p>代码的执行结果是：</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>perl</span><button class="flex ml-auto gap-2"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>Copy code</button></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-perl">{ <span class="hljs-string">'2'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'3'</span>: <span class="hljs-number">2</span>, <span class="hljs-keyword">length</span>: <span class="hljs-number">4</span>, <span class="hljs-keyword">splice</span>: [Function: <span class="hljs-keyword">splice</span>], <span class="hljs-keyword">push</span>: [Function: <span class="hljs-keyword">push</span>] }
</code></div></div></pre><p>在代码中，我们创建了一个名为 <code>obj</code> 的对象，它包含了一些属性和方法：</p><ul><li><code>2</code> 和 <code>3</code> 是对象的属性名，对应的属性值分别为 <code>3</code> 和 <code>4</code>。</li><li><code>length</code> 属性的值为 <code>2</code>。</li><li><code>splice</code> 和 <code>push</code> 是对象的两个方法，它们均继承自 <code>Array.prototype</code>。</li></ul><p>接下来，我们先调用了 <code>obj.push(1)</code> 方法，将值 <code>1</code> 加入到了 <code>obj</code> 对象中，此时 <code>obj</code> 对象的状态如下所示：</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>perl</span><button class="flex ml-auto gap-2"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>Copy code</button></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-perl">{ <span class="hljs-string">'2'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'3'</span>: <span class="hljs-number">4</span>, <span class="hljs-keyword">length</span>: <span class="hljs-number">3</span>, <span class="hljs-keyword">splice</span>: [Function: <span class="hljs-keyword">splice</span>], <span class="hljs-keyword">push</span>: [Function: <span class="hljs-keyword">push</span>] }
</code></div></div></pre><p>接着，我们又调用了 <code>obj.push(2)</code> 方法，将值 <code>2</code> 加入到了 <code>obj</code> 对象中，此时 <code>obj</code> 对象的状态如下所示：</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>perl</span><button class="flex ml-auto gap-2"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>Copy code</button></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-perl">{ <span class="hljs-string">'2'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'3'</span>: <span class="hljs-number">2</span>, <span class="hljs-keyword">length</span>: <span class="hljs-number">4</span>, <span class="hljs-keyword">splice</span>: [Function: <span class="hljs-keyword">splice</span>], <span class="hljs-keyword">push</span>: [Function: <span class="hljs-keyword">push</span>] }
</code></div></div></pre><p>可以看出，<code>obj</code> 对象的属性值发生了变化。这是因为在调用 <code>obj.push(1)</code> 方法时，由于 <code>obj</code> 对象继承了 <code>Array.prototype.push</code> 方法，因此 <code>push</code> 方法中的 <code>this</code> 指向的是 <code>obj</code> 对象本身，因此将值 <code>1</code> 加入到了 <code>obj</code> 对象的第二个属性位置上（即 <code>obj[2] = 1</code>）。而在调用 <code>obj.push(2)</code> 方法时，<code>push</code> 方法同样将值 <code>2</code> 加入到了 <code>obj</code> 对象的第三个属性位置上（即 <code>obj[3] = 2</code>）。因此最终得到的 <code>obj</code> 对象的状态为 <code>{ '2': 1, '3': 2, length: 4, splice: [Function: splice], push: [Function: push] }</code>。</p></div>


<h4>追问：上面的代码中 obj.push(1)， 为什么会加入到第二个属性位置上？</h4>

<div class="markdown prose w-full break-words dark:prose-invert dark"><p>在 JavaScript 中，数组是一种特殊的对象，其属性名是非负整数，称之为索引(index)，因此可以通过数组语法来访问这些属性。另外，对于非数组对象，其属性名可以是任意字符串。</p><p>在给数组对象添加属性时，如果属性名是非负整数，那么会被当作数组元素，会自动维护 <code>length</code> 属性；如果属性名是其他字符串，那么则被当作普通的对象属性。</p><p>根据这个规则，上述代码中的 <code>obj</code> 对象添加了两个属性 <code>2: 3</code> 和 <code>3: 4</code>，它们的属性名都是非负整数，因此被当作数组元素，被计入了 <code>length</code> 属性。而在执行 <code>obj.push(1)</code> 时，会向数组中添加一个新的元素，该元素的下标是数组的 <code>length</code> 属性值，也就是 <code>2</code>，因此添加到了第二个属性位置上。接着执行 <code>obj.push(2)</code> 时，同样会向数组中添加一个新的元素，该元素的下标是 <code>3</code>，也就是数组的第三个属性位置上。</p><p>最终，输出结果为：</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>perl</span><button class="flex ml-auto gap-2"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>Copy code</button></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-perl">{ <span class="hljs-string">'2'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'3'</span>: <span class="hljs-number">2</span>, <span class="hljs-keyword">length</span>: <span class="hljs-number">4</span>, <span class="hljs-keyword">splice</span>: [Function: <span class="hljs-keyword">splice</span>], <span class="hljs-keyword">push</span>: [Function: <span class="hljs-keyword">push</span>] }
</code></div></div></pre><p>其中，属性 <code>2</code> 和 <code>3</code> 被分别赋值为 <code>1</code> 和 <code>2</code>，而原来的值被覆盖了。因此，最终的结果是 <code>{ '2': 1, '3': 2, length: 4, splice: [Function: splice], push: [Function: push] }</code>。</p></div>
